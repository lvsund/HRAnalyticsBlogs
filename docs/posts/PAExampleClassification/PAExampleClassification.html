<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lyndon Sundmark, MBA">
<meta name="dcterms.date" content="2016-04-30">

<title>HRAnalyticsBlogs - People Analytics in R - Job Classification ‘Revisited’</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">HRAnalyticsBlogs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">People Analytics in R - Job Classification ‘Revisited’</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">HR Analytics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Lyndon Sundmark, MBA </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 30, 2016</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="PAExampleClassification.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="PAExampleClassification.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="PAExampleClassification.epub"><i class="bi bi-file"></i>ePub</a></li></ul></div></div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>About a year back I posted a couple of blog articles on Data Driven Job Classification, showing a variety of tools to do this including R, Azure machine Learning and a few others. Its purpose was to encourage HR folks to start thinking about HR’s future being more in the use of HR analytics.</p>
<p><a href="https://www.linkedin.com/pulse/data-driven-job-classification-lyndon-sundmark-mba?trk=mp-author-card" class="uri">https://www.linkedin.com/pulse/data-driven-job-classification-lyndon-sundmark-mba?trk=mp-author-card</a></p>
<p>As the terminology in People Analytics is continuing to unfold and evolve, it is becoming increasing apparent that one of the best ways to understand People Analytics -both stringently and widely at the same time is to see it as:</p>
<ul>
<li>“Data Driven” HR and HR Decision Making</li>
<li>When Data Science as a process and a field meets the HR context</li>
</ul>
<p>Seeing it this way helps prevent us from unnecessarily limiting the contribution that it can make, and yet at the same time help prevent proliferation of terminology to the point of meaninglessness. ‘Data driven’ must be how we conduct HR Management and decision making in the future. Data Science contributes to that goal by itself being a ‘data driven’ process.</p>
<p>Another way to not artificially limit the application of People Analytics, is to remind ourselves of the potential scope of the relevant HR context. People Analytics can be applied to:</p>
<ul>
<li><p><strong>information on what is happening to employees in the organization over time.</strong> Typically this is thought of as HR metrics/demographics. Many still see this as the ‘extent’ of HR analytics.</p></li>
<li><p><strong>how well the HR department conducts its business and operations.</strong> These are metrics related to process improvement. Right now this is more typically thought of in the ’quality improvement realm. But it’s still data driven decision making</p></li>
<li><p><strong>‘direct’ embedding of statistical algorithms in our HR methodologies- how we actually ‘do’ HR.</strong> There is huge application of People Analytics here. HR needs to get out of its traditional non-analytic methodologies paradigm where data science can be brought to bear.</p></li>
</ul>
<p><strong>People Analytics in R- Job Classification</strong> is an example of embedding statistical algorithms in our HR methodologies.</p>
<p>With that in mind, I thought I would do a <strong>‘revisit’</strong> of job classification as an example of People Analytics in R. By revisit, I mean let’s restrict the tool to R, and let’s apply the data science process/framework to it. This would put into into a format similar to my last 2 blog articles. Additionally, in this article more time will be spent on describing how we generate the data in the first place.</p>
<p>The files for this currrent blog article can be found in this location:</p>
<p><a href="https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6433&amp;authkey=!ABv-gHg5jVluYpc&amp;ithint=folder%2cxlsx" class="uri">https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6433&amp;authkey=!ABv-gHg5jVluYpc&amp;ithint=folder%2cxlsx</a></p>
</section>
<section id="applying-the-data-science-process" class="level1">
<h1>Applying the Data Science Process</h1>
<p>Let’s remind ourselves of those steps again.</p>
<section id="the-data-science-steps" class="level2">
<h2 class="anchored" data-anchor-id="the-data-science-steps">The Data Science Steps</h2>
<p><em>1. Define A Goal</em></p>
<p><em>2. Collect And Manage Data</em></p>
<p><em>3. Build the Model</em></p>
<p><em>4. Evaluate And Critique Model</em></p>
<p><em>5. Present Results and Document</em></p>
<p><em>6. Deploy Model</em></p>
<p>##1. Define A Goal</p>
<p>Ok - what is our goal here? Perhaps a quick primer on job classification would be in order to answer the question.</p>
<section id="a-quick-job-classification-primer" class="level3">
<h3 class="anchored" data-anchor-id="a-quick-job-classification-primer">A Quick Job Classification Primer</h3>
<p>Job Classification is at the heart of compensation and salary administration in HR. We desire to pay our employees fairly- both from an external and internal perspective. Salary surveys help us out on the external side. But job classification helps us out on the internal picture. We try to understand the similarities and differences between jobs in the organization.</p>
<p>At a base level, this process starts with documenting job descriptions. We document tasks, knowleges, and skills needed to complete the work of the organization as organized within our jobs. Usually as a result of job descriptions being documented, we design broader categories that the job descriptions fall into. We call these job classifications. They attempt to categorize like with like and distinguish between job descriptions that are different. We often are concerned with the characteristics of how responsibility, accountability, supervision, education level, experience etc vary between these classifications. And to tie into our compensations systems, we often have paygrades assigned to the classification.</p>
<p>So what is our goal in Job Classification? To properly categorize ‘job descriptions’ into appropriate job classifications. When job classifications are written they are, by definition, of a ‘known’, ‘intended’ population. Job descriptions until they are categorized are outside of that population. Once proper categorization is made of a job description, it becomes part of that ‘known’ population. It is ‘unknown’ by the population until then. When all the job descriptions are categorized into job classifications, both the job descriptions and the job classifications are part of the known population. Any new job description written in the future is unknown until it is classified as well.</p>
<p>Why is this significant to People Analytics? The above process indicates that we are trying to classify something, or find the right category, that we <strong>don’t know</strong> based on how it compares to a population we do <strong>know</strong>. HR job classification is the context here. It just so happens that in data science and statistics there are all sorts of algorithms designed to create categories or find the best fit among known categories.</p>
<p>For decades we have had job classification as a process in HR, and classification algorithms in statistics- but HR,in most organizations, is not recognizing this and the potential contribution it could/can make .</p>
<p><strong>So in People Analytics in R -Job Classification:</strong></p>
<p><strong>* our primary goal is to classify job descriptions into job classifications using the power of statistical algorithms to assist in prediction of best fit.</strong> <strong>* our secondary goal might be to help improve the design of our job classification system/framework.</strong></p>
</section>
</section>
<section id="collect-and-manage-data" class="level2">
<h2 class="anchored" data-anchor-id="collect-and-manage-data">2.Collect And Manage Data</h2>
<p>For purposes of this application of People Analytics, this step in the data science process will take the longest initially. This is because in almost every organization, the existing job classifications or categories, and the job descriptions themselves are not typically represented in numerical format suitable for statistical analysis. Sometimes, that which we are predicting- the pay grade is numeric because point methods are used in evaluation and different paygrades have different point ranges. But more often the job descriptions are narrative as are the job classification specs or summaries. For this blog article, we will assume that and delineate the steps required.</p>
<section id="collecting-the-data" class="level3">
<h3 class="anchored" data-anchor-id="collecting-the-data">Collecting The Data</h3>
<p>The following are typical steps:</p>
<ol type="1">
<li>Gather together the entire set of narrative, written job classification specifications.</li>
<li>Review all of them to determine what the common denominators are- what the organization is paying attention to , to differentiate them from each other.</li>
<li>For each of the common denominators, pay attention to descriptions of how much of that common denominator exists in each narrative, writing down the phrases that are used.</li>
<li>For each common denominator, develop an ordinal scale which assigns numbers and places them in a ‘less to more’ order</li>
<li>Create a datafile where each record (row) is one job classification, and where each column is either a common denominator or the job classification identifier or paygrade.</li>
<li>Code each job classification narrative into the datafile recording their common denominator information and other pertinent categorical information.</li>
</ol>
<section id="gather-together-the-entire-set-of-narrative-written-job-classification-specifications." class="level4">
<h4 class="anchored" data-anchor-id="gather-together-the-entire-set-of-narrative-written-job-classification-specifications.">Gather together the entire set of narrative, written job classification specifications.</h4>
<p>This initially represents the ‘total’ population of what will be a ‘known’ population. Ones that by definition represent the prescribed intended categories and levels of paygrades. These are going to be used to compare an ‘unknown’ population- unclassified job descriptions, to determine best fit. But before this can happen, we should have confidence that the job classifications themselves are well designed- since they will be the standard against which all job descriptions will be compared.</p>
</section>
<section id="review-all-of-them-to-determine-what-the-common-denominators-are" class="level4">
<h4 class="anchored" data-anchor-id="review-all-of-them-to-determine-what-the-common-denominators-are">Review all of them to determine what the common denominators are</h4>
<p>Technically speaking, anything that appears in the narrative could be considered a feature that is a common denominator including the tasks, knowledges described. But few organizations have that level of automation in their job descriptions. So generally broader features are used to describe common denominators. Often they may include the following:</p>
<ul>
<li>Education Level</li>
<li>Experience</li>
<li>Organizational Impact</li>
<li>Problem Solving</li>
<li>Supervision Received</li>
<li>Contact Level</li>
<li>Financial Budget Responsibility</li>
</ul>
<p>To be a common denominator they need to be mentioned or discernable in every job classification specification</p>
</section>
<section id="pay-attention-to-the-descriptions-of-how-much-of-that-common-denominator-exists-in-each-narrative" class="level4">
<h4 class="anchored" data-anchor-id="pay-attention-to-the-descriptions-of-how-much-of-that-common-denominator-exists-in-each-narrative">Pay attention to the descriptions of how much of that common denominator exists in each narrative</h4>
<p>For each of the above common denominators ( if these are ones you use), go through each narrative identify where the common denominator is mentioned and write down the words used to describe how much of it exists. Go through you entire set of job classification specs and tabulate these for each common denominator and each class spec.</p>
</section>
<section id="for-each-common-denominator-develop-an-ordinal-scale" class="level4">
<h4 class="anchored" data-anchor-id="for-each-common-denominator-develop-an-ordinal-scale">For each common denominator, develop an ordinal scale</h4>
<p>Ordinal means in order. You order the descriptions from less than to more than. Then apply a numerical indicator to it. 0 might mean it doesnt exist in any significant way, 1 might mean something at a low or introductory level, higher numbers meaning more of it. The scale should have as many numbers as distinguishable descriptions.(You may have to merge or collapse descriptions if it’s impossible to distinguish order)</p>
</section>
<section id="create-a-datafile" class="level4">
<h4 class="anchored" data-anchor-id="create-a-datafile">Create a datafile</h4>
<p>This might be a spreadsheet.</p>
<p>each record(row) will be one job classification, and each column will be either a common denominator or the job classification identifier or paygrade or other categorical information.</p>
</section>
<section id="code-each-job-classification-narrative-into-the-datafile" class="level4">
<h4 class="anchored" data-anchor-id="code-each-job-classification-narrative-into-the-datafile">Code each job classification narrative into the datafile</h4>
<p>Record their common denominator information and other pertinent categorical or identifying information. At the end of this task you will have as many records as you have written job classification specs.</p>
<p>At the end of this effort you will have something that looks like the data found at the following link:</p>
<p><a href="https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6435&amp;authkey=!AL37Wt0sVLrsUYA&amp;ithint=file%2ctxt" class="uri">https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6435&amp;authkey=!AL37Wt0sVLrsUYA&amp;ithint=file%2ctxt</a></p>
<p>###Manage The Data</p>
<p>In this step we check the data for errors, organize the data for model building, and take an initial look at what the data is telling us.</p>
</section>
<section id="check-the-data-for-errors" class="level4">
<h4 class="anchored" data-anchor-id="check-the-data-for-errors">Check the data for errors</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">#MYdataset &lt;- read.csv("jobclassinfo2.txt")</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>MYdataset<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"jobclassinfo2.txt"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">PG =</span> <span class="fu">col_factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"PG01"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PG02"</span>, <span class="st">"PG03"</span>, <span class="st">"PG04"</span>, <span class="st">"PG05"</span>, <span class="st">"PG06"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">"PG07"</span>, <span class="st">"PG08"</span>, <span class="st">"PG09"</span>, <span class="st">"PG10"</span>))))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(MYdataset,<span class="at">width=</span><span class="dv">80</span>,<span class="at">strict.width =</span><span class="st">"wrap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>spc_tbl_ [66 × 14] (S3: spec_tbl_df/tbl_df/tbl/data.frame)
$ ID : num [1:66] 1 2 3 4 5 6 7 8 9 10 ...
$ JobFamily : num [1:66] 1 1 1 1 2 2 2 2 2 3 ...
$ JobFamilyDescription: chr [1:66] "Accounting And Finance" "Accounting And
   Finance" "Accounting And Finance" "Accounting And Finance" ...
$ JobClass : num [1:66] 1 2 3 4 5 6 7 8 9 10 ...
$ JobClassDescription : chr [1:66] "Accountant I" "Accountant II" "Accountant
   III" "Accountant IV" ...
$ PayGrade : num [1:66] 5 6 8 10 1 2 3 4 5 4 ...
$ EducationLevel : num [1:66] 3 4 4 5 1 1 1 4 4 2 ...
$ Experience : num [1:66] 1 1 2 5 0 1 2 0 0 0 ...
$ OrgImpact : num [1:66] 3 5 6 6 1 1 1 1 4 1 ...
$ ProblemSolving : num [1:66] 3 4 5 6 1 1 2 2 3 4 ...
$ Supervision : num [1:66] 4 5 6 7 1 1 1 1 5 1 ...
$ ContactLevel : num [1:66] 3 7 7 8 1 2 3 3 7 1 ...
$ FinancialBudget : num [1:66] 5 7 10 11 1 3 3 5 7 2 ...
$ PG : Factor w/ 10 levels "PG01","PG02",..: 5 6 8 10 1 2 3 4 5 4 ...
- attr(*, "spec")=
.. cols(
..  ID = col_double(),
..  JobFamily = col_double(),
..  JobFamilyDescription = col_character(),
..  JobClass = col_double(),
..  JobClassDescription = col_character(),
..  PayGrade = col_double(),
..  EducationLevel = col_double(),
..  Experience = col_double(),
..  OrgImpact = col_double(),
..  ProblemSolving = col_double(),
..  Supervision = col_double(),
..  ContactLevel = col_double(),
..  FinancialBudget = col_double(),
..  PG = col_factor(levels = c("PG01", "PG02", "PG03", "PG04", "PG05", "PG06",
   "PG07", "PG08",
..  "PG09", "PG10"), ordered = FALSE, include_na = FALSE)
.. )
- attr(*, "problems")=&lt;externalptr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(MYdataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID          JobFamily      JobFamilyDescription    JobClass    
 Min.   : 1.00   Min.   : 1.000   Length:66            Min.   : 1.00  
 1st Qu.:17.25   1st Qu.: 4.000   Class :character     1st Qu.:17.25  
 Median :33.50   Median : 7.000   Mode  :character     Median :33.50  
 Mean   :33.50   Mean   : 7.606                        Mean   :33.50  
 3rd Qu.:49.75   3rd Qu.:11.000                        3rd Qu.:49.75  
 Max.   :66.00   Max.   :15.000                        Max.   :66.00  
                                                                      
 JobClassDescription    PayGrade      EducationLevel    Experience    
 Length:66           Min.   : 1.000   Min.   :1.000   Min.   : 0.000  
 Class :character    1st Qu.: 4.000   1st Qu.:2.000   1st Qu.: 0.000  
 Mode  :character    Median : 5.000   Median :4.000   Median : 1.000  
                     Mean   : 5.697   Mean   :3.167   Mean   : 1.758  
                     3rd Qu.: 8.000   3rd Qu.:4.000   3rd Qu.: 2.750  
                     Max.   :10.000   Max.   :6.000   Max.   :10.000  
                                                                      
   OrgImpact     ProblemSolving   Supervision     ContactLevel  
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:2.000   1st Qu.:3.000   1st Qu.:1.000   1st Qu.:3.000  
 Median :3.000   Median :4.000   Median :4.000   Median :6.000  
 Mean   :3.348   Mean   :3.606   Mean   :3.864   Mean   :4.758  
 3rd Qu.:4.000   3rd Qu.:5.000   3rd Qu.:5.750   3rd Qu.:7.000  
 Max.   :6.000   Max.   :6.000   Max.   :7.000   Max.   :8.000  
                                                                
 FinancialBudget        PG    
 Min.   : 1.000   PG05   :15  
 1st Qu.: 2.000   PG03   : 7  
 Median : 5.000   PG04   : 7  
 Mean   : 5.303   PG06   : 7  
 3rd Qu.: 7.750   PG08   : 7  
 Max.   :11.000   PG09   : 6  
                  (Other):17  </code></pre>
</div>
</div>
<p>On the surface there doesn’t seem to be any issues with data. This gives a summary of the layout of the data and the likely values we can expect. PG is the category we will predict. It’s a categorical representation of the numeric paygrade. Education level through Financial Budgeting Responsibility will be the independent variables/measures we will use to predict. The other columns in file will be ignored.</p>
</section>
<section id="organize-the-data" class="level4">
<h4 class="anchored" data-anchor-id="organize-the-data">Organize the data</h4>
<p>Lets narrow down the information to just the data used in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>MYnobs <span class="ot">&lt;-</span> <span class="fu">nrow</span>(MYdataset) <span class="co"># 66 observations </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>MYsample <span class="ot">&lt;-</span> MYtrain <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(MYdataset), <span class="fl">0.7</span><span class="sc">*</span>MYnobs) <span class="co"># 46 observations</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>MYvalidate <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">setdiff</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(MYdataset)), MYtrain), <span class="fl">0.14</span><span class="sc">*</span>MYnobs) <span class="co"># 9 observations</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>MYtest <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">setdiff</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(MYdataset)), MYtrain), MYvalidate) <span class="co"># 11 observations</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:43:48 x86_64-w64-mingw32 </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Note the user selections. </span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># The following variable selections have been noted.</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>MYinput <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EducationLevel"</span>, <span class="st">"Experience"</span>, <span class="st">"OrgImpact"</span>, <span class="st">"ProblemSolving"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Supervision"</span>, <span class="st">"ContactLevel"</span>, <span class="st">"FinancialBudget"</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>MYnumeric <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"EducationLevel"</span>, <span class="st">"Experience"</span>, <span class="st">"OrgImpact"</span>, <span class="st">"ProblemSolving"</span>,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>     <span class="st">"Supervision"</span>, <span class="st">"ContactLevel"</span>, <span class="st">"FinancialBudget"</span>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>MYcategoric <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>MYtarget  <span class="ot">&lt;-</span> <span class="st">"PG"</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>MYrisk    <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>MYident   <span class="ot">&lt;-</span> <span class="st">"ID"</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>MYignore  <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"JobFamily"</span>, <span class="st">"JobFamilyDescription"</span>, <span class="st">"JobClass"</span>, <span class="st">"JobClassDescription"</span>, <span class="st">"PayGrade"</span>)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>MYweights <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are predominantly interested in MYinput and MYtarget because they represent the predictors and what is to be predicted respectively. You will notice for the time being that we are not partitioning the data. This will be elaborated upon in model building.</p>
</section>
</section>
<section id="what-the-data-is-initially-telling-us" class="level3">
<h3 class="anchored" data-anchor-id="what-the-data-is-initially-telling-us">What the data is initially telling us</h3>
<p>Lets use the caret library again for some graphical representations of this data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">featurePlot</span>(<span class="at">x=</span>MYdataset[,<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>],<span class="at">y=</span>MYdataset<span class="sc">$</span>PG,<span class="at">plot=</span><span class="st">"density"</span>,<span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PAExampleClassification_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">featurePlot</span>(<span class="at">x=</span>MYdataset[,<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>],<span class="at">y=</span>MYdataset<span class="sc">$</span>PG,<span class="at">plot=</span><span class="st">"box"</span>,<span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PAExampleClassification_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The first set of charts show the distribution of the independent variable values(predictors) by PG.</p>
<p>The second set of charts show the range of values of the predictors by PG. PG is ordered left to right in ascending order from PG1 to PG10. In each of the predictors we would expect increasing levels as we move up the paygrades and from left to right (or at least not dropping from previous paygrade).</p>
<p>This is the first indication by a graphic ‘visual’ that we ‘may’ have problems in the data or the interpretation of the coding of the information. Then again the coding may be accurate based on our descriptions and our assumptions false. We will probably want to recheck our coding from the job description to make sure.</p>
</section>
</section>
<section id="build-the-model" class="level2">
<h2 class="anchored" data-anchor-id="build-the-model">3.Build The Model</h2>
<p>Lets use the rattle library to efficiently generate the code to run the following classification algorithms against our data:</p>
<ul>
<li>Decision Tree</li>
<li>Random Forest</li>
<li>Support Vector Machines</li>
<li>Linear</li>
</ul>
<section id="decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree">Decision Tree</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rattle)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: tibble</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: bitops</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Rattle: A free graphical interface for data science with R.
Version 5.5.1 Copyright (c) 2006-2021 Togaware Pty Ltd.
Type 'rattle()' to shake, rattle, and roll your data.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:51:16 x86_64-w64-mingw32 </span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Decision Tree </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'rpart' package provides the 'rpart' function.</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset the random number seed to obtain the same results each time.</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co">#crv$seed &lt;- 42 </span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(crv$seed)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the Decision Tree model.</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>MYrpart <span class="ot">&lt;-</span> <span class="fu">rpart</span>(PG <span class="sc">~</span> .,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>MYdataset[, <span class="fu">c</span>(MYinput, MYtarget)],</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">method=</span><span class="st">"class"</span>,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">parms=</span><span class="fu">list</span>(<span class="at">split=</span><span class="st">"information"</span>),</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">control=</span><span class="fu">rpart.control</span>(<span class="at">minsplit=</span><span class="dv">10</span>,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">minbucket=</span><span class="dv">2</span>,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">maxdepth=</span><span class="dv">10</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">usesurrogate=</span><span class="dv">0</span>, </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">maxsurrogate=</span><span class="dv">0</span>))</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a textual view of the Decision Tree model.</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(MYrpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 66 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 66 51 PG05 (0.03 0.076 0.11 0.11 0.23 0.11 0.061 0.11 0.091 0.091)  
   2) ProblemSolving&lt; 4.5 47 32 PG05 (0.043 0.11 0.15 0.15 0.32 0.15 0.085 0 0 0)  
     4) ContactLevel&lt; 5.5 32 21 PG05 (0.062 0.16 0.22 0.22 0.34 0 0 0 0 0)  
       8) EducationLevel&lt; 1.5 15  9 PG03 (0.13 0.33 0.4 0.13 0 0 0 0 0 0)  
        16) ProblemSolving&lt; 1.5 5  2 PG02 (0.4 0.6 0 0 0 0 0 0 0 0) *
        17) ProblemSolving&gt;=1.5 10  4 PG03 (0 0.2 0.6 0.2 0 0 0 0 0 0)  
          34) Experience&lt; 0.5 3  1 PG02 (0 0.67 0 0.33 0 0 0 0 0 0) *
          35) Experience&gt;=0.5 7  1 PG03 (0 0 0.86 0.14 0 0 0 0 0 0) *
       9) EducationLevel&gt;=1.5 17  6 PG05 (0 0 0.059 0.29 0.65 0 0 0 0 0)  
        18) Experience&lt; 0.5 8  3 PG04 (0 0 0 0.62 0.37 0 0 0 0 0) *
        19) Experience&gt;=0.5 9  1 PG05 (0 0 0.11 0 0.89 0 0 0 0 0) *
     5) ContactLevel&gt;=5.5 15  8 PG06 (0 0 0 0 0.27 0.47 0.27 0 0 0)  
      10) Experience&lt; 2.5 12  5 PG06 (0 0 0 0 0.33 0.58 0.083 0 0 0)  
        20) ContactLevel&gt;=6.5 8  4 PG05 (0 0 0 0 0.5 0.38 0.13 0 0 0) *
        21) ContactLevel&lt; 6.5 4  0 PG06 (0 0 0 0 0 1 0 0 0 0) *
      11) Experience&gt;=2.5 3  0 PG07 (0 0 0 0 0 0 1 0 0 0) *
   3) ProblemSolving&gt;=4.5 19 12 PG08 (0 0 0 0 0 0 0 0.37 0.32 0.32)  
     6) ProblemSolving&lt; 5.5 13  6 PG08 (0 0 0 0 0 0 0 0.54 0.46 0)  
      12) ContactLevel&gt;=6.5 10  3 PG08 (0 0 0 0 0 0 0 0.7 0.3 0) *
      13) ContactLevel&lt; 6.5 3  0 PG09 (0 0 0 0 0 0 0 0 1 0) *
     7) ProblemSolving&gt;=5.5 6  0 PG10 (0 0 0 0 0 0 0 0 0 1) *</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printcp</span>(MYrpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Classification tree:
rpart(formula = PG ~ ., data = MYdataset[, c(MYinput, MYtarget)], 
    method = "class", parms = list(split = "information"), control = rpart.control(minsplit = 10, 
        minbucket = 2, maxdepth = 10, usesurrogate = 0, maxsurrogate = 0))

Variables actually used in tree construction:
[1] ContactLevel   EducationLevel Experience     ProblemSolving

Root node error: 51/66 = 0.77273

n= 66 

        CP nsplit rel error  xerror     xstd
1 0.137255      0   1.00000 1.00000 0.066756
2 0.117647      1   0.86275 0.98039 0.068266
3 0.088235      2   0.74510 0.94118 0.070944
4 0.058824      4   0.56863 0.78431 0.077835
5 0.039216      7   0.39216 0.74510 0.078728
6 0.019608      9   0.31373 0.72549 0.079060
7 0.010000     10   0.29412 0.68627 0.079501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken: 0.02 secs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest">Random Forest</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:51:16 x86_64-w64-mingw32 </span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Random Forest </span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'randomForest' package provides the 'randomForest' function.</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:rattle':

    importance</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the Random Forest model.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(crv$seed)</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>MYrf <span class="ot">&lt;-</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(PG <span class="sc">~</span> .,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)], </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">ntree=</span><span class="dv">500</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">mtry=</span><span class="dv">2</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance=</span><span class="cn">TRUE</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">na.action=</span>randomForest<span class="sc">::</span>na.roughfix,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">replace=</span><span class="cn">FALSE</span>)</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate textual output of 'Random Forest' model.</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>MYrf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = PG ~ ., data = MYdataset[, c(MYinput,      MYtarget)], ntree = 500, mtry = 2, importance = TRUE, replace = FALSE,      na.action = randomForest::na.roughfix) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 2

        OOB estimate of  error rate: 37.88%
Confusion matrix:
     PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10 class.error
PG01    0    2    0    0    0    0    0    0    0    0   1.0000000
PG02    0    4    1    0    0    0    0    0    0    0   0.2000000
PG03    0    0    5    1    1    0    0    0    0    0   0.2857143
PG04    0    0    1    3    3    0    0    0    0    0   0.5714286
PG05    0    0    0    3   10    2    0    0    0    0   0.3333333
PG06    0    0    0    0    1    6    0    0    0    0   0.1428571
PG07    0    0    0    0    0    3    1    0    0    0   0.7500000
PG08    0    0    0    0    0    0    0    4    2    1   0.4285714
PG09    0    0    0    0    0    0    0    4    2    0   0.6666667
PG10    0    0    0    0    0    0    0    0    0    6   0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List the importance of the variables.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>rn <span class="ot">&lt;-</span> <span class="fu">round</span>(randomForest<span class="sc">::</span><span class="fu">importance</span>(MYrf), <span class="dv">2</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>rn[<span class="fu">order</span>(rn[,<span class="dv">3</span>], <span class="at">decreasing=</span><span class="cn">TRUE</span>),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 PG01  PG02  PG03 PG04  PG05  PG06  PG07  PG08  PG09  PG10
EducationLevel   2.85 15.84 12.83 4.29  6.42  2.03  5.47  6.35 -4.76  8.29
ProblemSolving   3.93  6.34  9.25 2.34  7.62 12.13  8.43 13.24 10.21 19.68
Experience      -4.44 10.20  9.16 4.67  2.36  6.31  9.03 -5.78  4.93  3.32
Supervision     -3.08  9.00  7.30 2.75  7.00  4.17  0.00  3.40  3.78 15.64
ContactLevel     2.46 11.88  3.88 3.89  2.77 10.43  3.70 10.34 -1.38 10.47
OrgImpact       -2.52 10.59  3.67 2.58 10.19  1.78  5.61 -0.91  6.30 10.58
FinancialBudget  2.25  6.28  3.59 1.65  8.66  2.95 -3.59 -5.06 11.90 15.03
                MeanDecreaseAccuracy MeanDecreaseGini
EducationLevel                 17.97             4.61
ProblemSolving                 23.60             6.30
Experience                     13.86             4.42
Supervision                    16.30             3.82
ContactLevel                   16.10             4.93
OrgImpact                      14.17             3.38
FinancialBudget                13.79             5.24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken: 0.06 secs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="support-vector-machine" class="level3">
<h3 class="anchored" data-anchor-id="support-vector-machine">Support Vector Machine</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:51:16 x86_64-w64-mingw32 </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Support vector machine. </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The 'kernlab' package provides the 'ksvm' function.</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kernlab, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kernlab'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a Support Vector Machine model.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co">#set.seed(crv$seed)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>MYksvm <span class="ot">&lt;-</span> <span class="fu">ksvm</span>(<span class="fu">as.factor</span>(PG) <span class="sc">~</span> .,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data=</span>MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)],</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">kernel=</span><span class="st">"rbfdot"</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">prob.model=</span><span class="cn">TRUE</span>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a textual view of the SVM model.</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>MYksvm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machine object of class "ksvm" 

SV type: C-svc  (classification) 
 parameter : cost C = 1 

Gaussian Radial Basis kernel function. 
 Hyperparameter : sigma =  0.151222236388729 

Number of Support Vectors : 64 

Objective Function Value : -3.8437 -3.6794 -2.9812 -2.3382 -1.5472 -1.3242 -1.3688 -1.5097 -1.3689 -7.7967 -4.483 -2.6257 -1.6532 -1.3211 -1.3594 -1.5029 -1.3566 -8.6345 -6.5264 -3.1206 -2.3037 -1.8315 -2.088 -1.6889 -10.3209 -3.9815 -2.5211 -2.0744 -2.4871 -1.8299 -10.2577 -6.5316 -3.8955 -3.8986 -2.2741 -7.6954 -5.6307 -4.8631 -2.3234 -4.7859 -4.1069 -2.112 -9.9423 -6.2772 -6.586 
Training error : 0.30303 
Probability model included. </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken: 0.43 secs</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="linear-model" class="level3">
<h3 class="anchored" data-anchor-id="linear-model">Linear Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:51:17 x86_64-w64-mingw32 </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Regression model </span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a multinomial model using the nnet package.</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise multinomial model using Anova from the car package.</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Build a Regression model.</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>MYglm <span class="ot">&lt;-</span> <span class="fu">multinom</span>(PG <span class="sc">~</span> ., <span class="at">data=</span>MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)], <span class="at">trace=</span><span class="cn">FALSE</span>, <span class="at">maxit=</span><span class="dv">1000</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a textual view of the Linear model.</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">rattle.print.summary.multinom</span>(<span class="fu">summary</span>(MYglm,</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>                              <span class="at">Wald.ratios=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in sqrt(diag(vc)): NaNs produced</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
multinom(formula = PG ~ ., data = MYdataset[, c(MYinput, MYtarget)], 
    trace = FALSE, maxit = 1000)

n=66

Coefficients:
     (Intercept) EducationLevel  Experience  OrgImpact ProblemSolving
PG02   31570.140     -29546.246 -10054.5402 -31742.949       22887.11
PG03    5173.408     -13991.742  17611.5597 -23434.513       27580.11
PG04  -12639.313       3742.145  -5763.6011 -11968.730       18528.68
PG05  -29223.399       5164.052   1451.4069 -12579.427       21540.91
PG06  -64936.850       5381.517   1332.3066 -10153.015       27846.30
PG07  -55186.714       5379.689   1334.2282 -10155.643       25405.97
PG08 -124914.252       6197.617    572.4667 -13900.558       42485.72
PG09  -97759.116     -14428.508   8698.6998  -8681.908      -21901.43
PG10 -201459.455       9187.762    765.1991 -15483.566       54919.25
     Supervision ContactLevel FinancialBudget
PG02   -3826.376   -3466.3364       14125.347
PG03   -7979.596    4054.9295       -2131.931
PG04   -1202.967   -4060.4297        6156.244
PG05   -3137.087    -986.4325        5756.414
PG06   -3540.354    -746.1415        6259.916
PG07   -3539.699    -742.8932        6259.885
PG08   -1862.503   -1725.1769        7267.505
PG09   21068.207  -12739.5580       34119.536
PG10   -2773.094    1152.7658        5960.684

Std. Errors:
      (Intercept) EducationLevel   Experience    OrgImpact ProblemSolving
PG02 1.749631e-01   1.749631e-01 0.000000e+00 1.749631e-01   1.749631e-01
PG03 0.000000e+00   0.000000e+00 0.000000e+00 0.000000e+00   0.000000e+00
PG04 0.000000e+00            NaN          NaN 1.776635e-14   7.258525e-15
PG05 4.576029e-16   2.976903e-15 2.398744e-16 1.189550e-16   1.716121e-16
PG06 3.859338e-01   1.397271e+00 6.650459e-01 1.366421e+00   1.543735e+00
PG07 3.859338e-01   1.397271e+00 6.650459e-01 1.366421e+00   1.543735e+00
PG08 0.000000e+00   0.000000e+00 0.000000e+00 0.000000e+00   0.000000e+00
PG09 0.000000e+00   0.000000e+00 0.000000e+00 0.000000e+00   0.000000e+00
PG10 0.000000e+00   0.000000e+00 0.000000e+00 0.000000e+00   0.000000e+00
      Supervision ContactLevel FinancialBudget
PG02 1.749631e-01 1.749631e-01    1.749631e-01
PG03 0.000000e+00 0.000000e+00    0.000000e+00
PG04 4.074351e-15          NaN             NaN
PG05 7.348316e-17 2.343827e-15    4.111322e-17
PG06 8.809021e-01 1.298034e+00    3.216738e-01
PG07 8.809021e-01 1.298034e+00    3.216738e-01
PG08 0.000000e+00 0.000000e+00    0.000000e+00
PG09 0.000000e+00 0.000000e+00    0.000000e+00
PG10 0.000000e+00 0.000000e+00    0.000000e+00

Value/SE (Wald statistics):
       (Intercept) EducationLevel   Experience     OrgImpact ProblemSolving
PG02  1.804388e+05  -1.688713e+05         -Inf -1.814265e+05   1.308111e+05
PG03           Inf           -Inf          Inf          -Inf            Inf
PG04          -Inf            NaN          NaN -6.736740e+17   2.552679e+18
PG05 -6.386192e+19   1.734706e+18 6.050696e+18 -1.057495e+20   1.255209e+20
PG06 -1.682590e+05   3.851448e+03 2.003330e+03 -7.430373e+03   1.803826e+04
PG07 -1.429953e+05   3.850140e+03 2.006220e+03 -7.432296e+03   1.645746e+04
PG08          -Inf            Inf          Inf          -Inf            Inf
PG09          -Inf           -Inf          Inf          -Inf           -Inf
PG10          -Inf            Inf          Inf          -Inf            Inf
       Supervision  ContactLevel FinancialBudget
PG02 -2.186961e+04 -1.981181e+04    8.073327e+04
PG03          -Inf           Inf            -Inf
PG04 -2.952536e+17           NaN             NaN
PG05 -4.269123e+19 -4.208639e+17    1.400137e+20
PG06 -4.019010e+03 -5.748241e+02    1.946045e+04
PG07 -4.018266e+03 -5.723216e+02    1.946035e+04
PG08          -Inf          -Inf             Inf
PG09           Inf          -Inf             Inf
PG10          -Inf           Inf             Inf

Residual Deviance: 13.0907 
AIC: 157.0907 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Log likelihood: %.3f (%d df)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>, <span class="fu">logLik</span>(MYglm)[<span class="dv">1</span>], <span class="fu">attr</span>(<span class="fu">logLik</span>(MYglm), <span class="st">"df"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Log likelihood: -6.545 (72 df)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">is.null</span>(MYglm<span class="sc">$</span>na.action)) omitted <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="cf">else</span> omitted <span class="ot">&lt;-</span> <span class="sc">-</span>MYglm<span class="sc">$</span>na.action</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">sprintf</span>(<span class="st">"Pseudo R-Square: %.8f</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>,<span class="fu">cor</span>(<span class="fu">apply</span>(MYglm<span class="sc">$</span>fitted.values, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">which</span>(x <span class="sc">==</span> <span class="fu">max</span>(x))),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as.integer</span>(MYdataset[omitted,]<span class="sc">$</span>PG))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pseudo R-Square: 0.99516038</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'==== ANOVA ====</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="st">'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>==== ANOVA ====</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Anova</span>(MYglm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: PG
                LR Chisq Df Pr(&gt;Chisq)   
EducationLevel   14.3433  9   0.110626   
Experience       24.2064  9   0.003987 **
OrgImpact         1.6140  9   0.996209   
ProblemSolving   21.1081  9   0.012179 * 
Supervision       2.9187  9   0.967430   
ContactLevel      4.8563  9   0.846653   
FinancialBudget   5.5476  9   0.784206   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "\n"</code></pre>
</div>
</div>
<p>Now lets plot the Decision Tree</p>
</section>
<section id="decision-tree-plot" class="level3">
<h3 class="anchored" data-anchor-id="decision-tree-plot">Decision Tree Plot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time taken: 0.16 secs</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 12:51:52 x86_64-w64-mingw32 </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resulting Decision Tree. </span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># We use the rpart.plot package.</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(MYrpart, <span class="at">main=</span><span class="st">"Decision Tree MYdataset $ PG"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PAExampleClassification_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>A readable view of the decision tree can be found at the following pdf:</p>
<p><a href="https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6449&amp;authkey=!ACgJAX951UZuo4s&amp;ithint=file%2cpdf" class="uri">https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6449&amp;authkey=!ACgJAX951UZuo4s&amp;ithint=file%2cpdf</a></p>
<p>##4.Evaluate And Critique Model</p>
<p>###Evaluate</p>
<p>Because we have multiple categories to be predicted, the only evaluation used is Error Matricies.</p>
<p>Lets see how well the models performed.</p>
<section id="decision-tree-1" class="level4">
<h4 class="anchored" data-anchor-id="decision-tree-1">Decision Tree</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#============================================================</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rattle timestamp: 2016-04-27 13:11:52 x86_64-w64-mingw32 </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluate model performance. </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an Error Matrix for the Decision Tree model.</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the response from the Decision Tree model.</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>MYpr <span class="ot">&lt;-</span> <span class="fu">predict</span>(MYrpart, <span class="at">newdata=</span>MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)], <span class="at">type=</span><span class="st">"class"</span>)</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing counts.</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]<span class="sc">$</span>PG, MYpr,</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10
  PG01    0    2    0    0    0    0    0    0    0    0
  PG02    0    5    0    0    0    0    0    0    0    0
  PG03    0    0    6    0    1    0    0    0    0    0
  PG04    0    1    1    5    0    0    0    0    0    0
  PG05    0    0    0    3   12    0    0    0    0    0
  PG06    0    0    0    0    3    4    0    0    0    0
  PG07    0    0    0    0    1    0    3    0    0    0
  PG08    0    0    0    0    0    0    0    7    0    0
  PG09    0    0    0    0    0    0    0    3    3    0
  PG10    0    0    0    0    0    0    0    0    0    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing proportions.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>pcme <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, cl)</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, cl)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">/</span><span class="fu">length</span>(actual),</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Error=</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nc,</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(r) <span class="fu">round</span>(<span class="fu">sum</span>(x[r,<span class="sc">-</span>r])<span class="sc">/</span><span class="fu">sum</span>(x[r,]), <span class="dv">2</span>)))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(<span class="fu">attr</span>(tbl, <span class="st">"dimnames"</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tbl)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="fu">pcme</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]<span class="sc">$</span>PG, MYpr)</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(per, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10 Error
  PG01    0 0.03 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  1.00
  PG02    0 0.08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.00
  PG03    0 0.00 0.09 0.00 0.02 0.00 0.00 0.00 0.00 0.00  0.14
  PG04    0 0.02 0.02 0.08 0.00 0.00 0.00 0.00 0.00 0.00  0.29
  PG05    0 0.00 0.00 0.05 0.18 0.00 0.00 0.00 0.00 0.00  0.20
  PG06    0 0.00 0.00 0.00 0.05 0.06 0.00 0.00 0.00 0.00  0.43
  PG07    0 0.00 0.00 0.00 0.02 0.00 0.05 0.00 0.00 0.00  0.25
  PG08    0 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00  0.00
  PG09    0 0.00 0.00 0.00 0.00 0.00 0.00 0.05 0.05 0.00  0.50
  PG10    0 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.09  0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall error percentage.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">diag</span>(per), <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>23</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the averaged class error percentage.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">mean</span>(per[,<span class="st">"Error"</span>], <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>28</code></pre>
</div>
</div>
</section>
<section id="random-forest-1" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-1">Random Forest</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an Error Matrix for the Random Forest model.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the response from the Random Forest model.</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>MYpr <span class="ot">&lt;-</span> <span class="fu">predict</span>(MYrf, <span class="at">newdata=</span><span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]))</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing counts.</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)])<span class="sc">$</span>PG, MYpr,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10
  PG01    1    1    0    0    0    0    0    0    0    0
  PG02    0    5    0    0    0    0    0    0    0    0
  PG03    0    0    7    0    0    0    0    0    0    0
  PG04    0    0    0    7    0    0    0    0    0    0
  PG05    0    0    0    0   15    0    0    0    0    0
  PG06    0    0    0    0    0    7    0    0    0    0
  PG07    0    0    0    0    0    0    4    0    0    0
  PG08    0    0    0    0    0    0    0    7    0    0
  PG09    0    0    0    0    0    0    0    0    6    0
  PG10    0    0    0    0    0    0    0    0    0    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing proportions.</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>pcme <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, cl)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, cl)</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">/</span><span class="fu">length</span>(actual),</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Error=</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nc,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(r) <span class="fu">round</span>(<span class="fu">sum</span>(x[r,<span class="sc">-</span>r])<span class="sc">/</span><span class="fu">sum</span>(x[r,]), <span class="dv">2</span>)))</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(<span class="fu">attr</span>(tbl, <span class="st">"dimnames"</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tbl)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="fu">pcme</span>(<span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)])<span class="sc">$</span>PG, MYpr)</span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(per, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10 Error
  PG01 0.02 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00   0.5
  PG02 0.00 0.08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00   0.0
  PG03 0.00 0.00 0.11 0.00 0.00 0.00 0.00 0.00 0.00 0.00   0.0
  PG04 0.00 0.00 0.00 0.11 0.00 0.00 0.00 0.00 0.00 0.00   0.0
  PG05 0.00 0.00 0.00 0.00 0.23 0.00 0.00 0.00 0.00 0.00   0.0
  PG06 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00 0.00 0.00   0.0
  PG07 0.00 0.00 0.00 0.00 0.00 0.00 0.06 0.00 0.00 0.00   0.0
  PG08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00   0.0
  PG09 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.09 0.00   0.0
  PG10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.09   0.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall error percentage.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">diag</span>(per), <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the averaged class error percentage.</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">mean</span>(per[,<span class="st">"Error"</span>], <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>5</code></pre>
</div>
</div>
</section>
<section id="support-vector-machine-1" class="level4">
<h4 class="anchored" data-anchor-id="support-vector-machine-1">Support Vector Machine</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an Error Matrix for the SVM model.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the response from the SVM model.</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>MYpr <span class="ot">&lt;-</span> kernlab<span class="sc">::</span><span class="fu">predict</span>(MYksvm, <span class="at">newdata=</span><span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]))</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing counts.</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)])<span class="sc">$</span>PG, MYpr,</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10
  PG01    0    1    1    0    0    0    0    0    0    0
  PG02    0    4    1    0    0    0    0    0    0    0
  PG03    0    0    5    0    2    0    0    0    0    0
  PG04    0    0    0    6    1    0    0    0    0    0
  PG05    0    0    0    1   12    2    0    0    0    0
  PG06    0    0    0    0    2    5    0    0    0    0
  PG07    0    0    0    0    0    4    0    0    0    0
  PG08    0    0    0    0    0    1    0    6    0    0
  PG09    0    0    0    0    0    0    0    4    2    0
  PG10    0    0    0    0    0    0    0    0    0    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing proportions.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>pcme <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, cl)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, cl)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">/</span><span class="fu">length</span>(actual),</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Error=</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nc,</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(r) <span class="fu">round</span>(<span class="fu">sum</span>(x[r,<span class="sc">-</span>r])<span class="sc">/</span><span class="fu">sum</span>(x[r,]), <span class="dv">2</span>)))</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(<span class="fu">attr</span>(tbl, <span class="st">"dimnames"</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tbl)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="fu">pcme</span>(<span class="fu">na.omit</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)])<span class="sc">$</span>PG, MYpr)</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(per, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10 Error
  PG01    0 0.02 0.02 0.00 0.00 0.00    0 0.00 0.00 0.00  1.00
  PG02    0 0.06 0.02 0.00 0.00 0.00    0 0.00 0.00 0.00  0.20
  PG03    0 0.00 0.08 0.00 0.03 0.00    0 0.00 0.00 0.00  0.29
  PG04    0 0.00 0.00 0.09 0.02 0.00    0 0.00 0.00 0.00  0.14
  PG05    0 0.00 0.00 0.02 0.18 0.03    0 0.00 0.00 0.00  0.20
  PG06    0 0.00 0.00 0.00 0.03 0.08    0 0.00 0.00 0.00  0.29
  PG07    0 0.00 0.00 0.00 0.00 0.06    0 0.00 0.00 0.00  1.00
  PG08    0 0.00 0.00 0.00 0.00 0.02    0 0.09 0.00 0.00  0.14
  PG09    0 0.00 0.00 0.00 0.00 0.00    0 0.06 0.03 0.00  0.67
  PG10    0 0.00 0.00 0.00 0.00 0.00    0 0.00 0.00 0.09  0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall error percentage.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">diag</span>(per), <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the averaged class error percentage.</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">mean</span>(per[,<span class="st">"Error"</span>], <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>39</code></pre>
</div>
</div>
</section>
<section id="linear-model-1" class="level4">
<h4 class="anchored" data-anchor-id="linear-model-1">Linear Model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate an Error Matrix for the Linear model.</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain the response from the Linear model.</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>MYpr <span class="ot">&lt;-</span> <span class="fu">predict</span>(MYglm, <span class="at">newdata=</span>MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)])</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing counts.</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]<span class="sc">$</span>PG, MYpr,</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">dnn=</span><span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10
  PG01    1    1    0    0    0    0    0    0    0    0
  PG02    0    5    0    0    0    0    0    0    0    0
  PG03    0    0    7    0    0    0    0    0    0    0
  PG04    0    0    0    7    0    0    0    0    0    0
  PG05    0    0    0    0   15    0    0    0    0    0
  PG06    0    0    0    0    0    6    1    0    0    0
  PG07    0    0    0    0    0    2    2    0    0    0
  PG08    0    0    0    0    0    0    0    7    0    0
  PG09    0    0    0    0    0    0    0    0    6    0
  PG10    0    0    0    0    0    0    0    0    0    6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the confusion matrix showing proportions.</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>pcme <span class="ot">&lt;-</span> <span class="cf">function</span>(actual, cl)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">table</span>(actual, cl)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  nc <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  tbl <span class="ot">&lt;-</span> <span class="fu">cbind</span>(x<span class="sc">/</span><span class="fu">length</span>(actual),</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">Error=</span><span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>nc,</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                 <span class="cf">function</span>(r) <span class="fu">round</span>(<span class="fu">sum</span>(x[r,<span class="sc">-</span>r])<span class="sc">/</span><span class="fu">sum</span>(x[r,]), <span class="dv">2</span>)))</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(<span class="fu">attr</span>(tbl, <span class="st">"dimnames"</span>)) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Actual"</span>, <span class="st">"Predicted"</span>)</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tbl)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>per <span class="ot">&lt;-</span> <span class="fu">pcme</span>(MYdataset[,<span class="fu">c</span>(MYinput, MYtarget)]<span class="sc">$</span>PG, MYpr)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(per, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Predicted
Actual PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10 Error
  PG01 0.02 0.02 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.50
  PG02 0.00 0.08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.00
  PG03 0.00 0.00 0.11 0.00 0.00 0.00 0.00 0.00 0.00 0.00  0.00
  PG04 0.00 0.00 0.00 0.11 0.00 0.00 0.00 0.00 0.00 0.00  0.00
  PG05 0.00 0.00 0.00 0.00 0.23 0.00 0.00 0.00 0.00 0.00  0.00
  PG06 0.00 0.00 0.00 0.00 0.00 0.09 0.02 0.00 0.00 0.00  0.14
  PG07 0.00 0.00 0.00 0.00 0.00 0.03 0.03 0.00 0.00 0.00  0.50
  PG08 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.11 0.00 0.00  0.00
  PG09 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.09 0.00  0.00
  PG10 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.09  0.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the overall error percentage.</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">sum</span>(<span class="fu">diag</span>(per), <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the averaged class error percentage.</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(<span class="fu">mean</span>(per[,<span class="st">"Error"</span>], <span class="at">na.rm=</span><span class="cn">TRUE</span>), <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>11</code></pre>
</div>
</div>
</section>
</section>
<section id="critique" class="level3">
<h3 class="anchored" data-anchor-id="critique">Critique</h3>
<p>It turns out that:</p>
<ul>
<li>The model that performed best was Random Forests at 2% error</li>
<li>The linear model was next at 6% error.<br>
</li>
<li>Support Vector Machines performed less well at 18% error.</li>
<li>And Decision trees, while being able to give us ‘visual’ on what rules are being used, performed worst of all at 23% error.</li>
</ul>
<p>Earlier I said ,that for purposes of this analysis, we would not have training and test datasets. This is because the total population of our data is only 66 records which are scattered among up to 10 categories. Unless we took special care, if we randomly created test and training datasets, we could not guarantee that each of these datasets would have all 10 groups represented. So we use all the data to predict itself.(usually not recommended if lots of data)</p>
<p>If as an organization , we were just starting out with this kind of endeavor, at this point you would only have the job classification specs coded into the dataset. it would be the only ‘known’ population. In some ways it is useful to do this here- to gauge how well designed our paygrades are ‘differentiated’ from each other. Even though we know that the known population predicting itself will give lower error rates, suffice to say that here, the hypothetical organization is seeing results that would make it worthwhile to expand the coding effort. If at this stage, the data could not reliably predict itself, we might to rethink our approach.</p>
<p>In most organizations who have written job descriptions and job classification specs, their job descriptions <strong>are</strong> already classified as well. So we arent necessarily restricted to just coding the job class specs. We could go ahead and code the job descriptions on the same common denominator features.( outside the context of this blog article) This would make the ‘known’ population quite a bit bigger. On a bigger population too we could <strong>also</strong> have the population predict itself but additionally do cross validation and have both training and test datasets.</p>
<p>While the above results were found on just the job class specs, it would be wise to have a much larger population before deciding on which model is best to deploy in real life.</p>
<p>One other observation- you noticed in the results of the various models, that some model had predictions that were one or two paygrades off ‘higher or lower’ than the actual existing paygrade.</p>
<p>In a practical sense this might mean:</p>
<ul>
<li>these might be candidates for determining whether criteria/features for these pay grades should be redefined</li>
<li>and or whether there are ,in reality, fewer categories needed.</li>
</ul>
<p>We could extend our analysis and modelling to ‘cluster’ analysis.This would create a newer grouping based on the existing characteristics, and then the classification algorithms could be rerun to see if there was any improvement.</p>
<p>Some articles on People Analytics suggest that on a ‘maturity level’ basis, the step/stage beyond prediction is ‘experimental design’. If we are using our results to modify our design of our systems to predict better, that might be an example of this.</p>
</section>
</section>
<section id="present-results-and-document" class="level2">
<h2 class="anchored" data-anchor-id="present-results-and-document">5.Present Results And Document</h2>
<p>As with previous blog articles, a good way of carrying out this step is this the .rmd file which is used to create this blog article. R Markdown language is used to create this narrative as well as allow for ‘inline’ inclusion of the R program and its output. The rmd file can be found here:</p>
<p>https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6467&amp;authkey=!AE4IyMNEaoLgqnw&amp;ithint=file%2cRmd</p>
<p>##6.Deploy The Model</p>
<p>In R the easiest form of deploying the model, is to run your unknown data against the model . Put the data in a separate dataset and run the following R commands:</p>
<p>Here is dataset:</p>
<p><a href="https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6478&amp;authkey=!ALYidIIpaCrfnf4&amp;ithint=file%2ccsv" class="uri">https://onedrive.live.com/redir?resid=4EF2CCBEDB98D0F5!6478&amp;authkey=!ALYidIIpaCrfnf4&amp;ithint=file%2ccsv</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DeployDataset &lt;- read.csv("~/Documents/OneDrive/Public/R Job Classification Example/Deploydata.csv")</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>DeployDataset <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Deploydata.csv"</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>DeployDataset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  EducationLevel Experience OrgImpact ProblemSolving Supervision ContactLevel
1              2          0         3              4           1            5
  FinancialBudget
1               4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>PredictedJobGrade <span class="ot">&lt;-</span> <span class="fu">predict</span>(MYrf, <span class="at">newdata=</span>DeployDataset)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>PredictedJobGrade</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1 
PG05 
Levels: PG01 PG02 PG03 PG04 PG05 PG06 PG07 PG08 PG09 PG10</code></pre>
</div>
</div>
<p>The DeployDataset represemts the information coded from a single job description (paygrade not known). PredictedJobGrade compares the coded values against the MYrf (random forest model) and the prediction is determined. In this case - PG05.</p>
</section>
</section>
<section id="final-comments" class="level1">
<h1>Final Comments</h1>
<p>This is the third in a series of blog articles I have written to illustrate the use of People Analytics- <strong>data driven</strong> decision making for HR.</p>
<p>These articles have had the intention of providing real tangible examples of the application of data science to HR, to illustrate the data science process in the HR context, and to show that the scope mentioned previously in this article, isnt just theoretical- its real.</p>
<p>None of the articles is intended to illustrate necessarily best practices, but rather to show a structured process of thinking and analysis. The intention has also been to encourage more of being ‘data driven’ in HR, making People Analytics not an addon to HR but rather THE way we conducted HR decision making in the future, where applicable, human judgement is ‘added on’ to a rigorous analysis of the data in the first place.’</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>